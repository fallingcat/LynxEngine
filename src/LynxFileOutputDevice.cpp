//###########################################################################
//    __                    ____            __
//   / /  __ __ ___ _  __  / __/___  ____  /_/___  ____
//  / /__/ // /  _ \ \/ / / __/  _ \/ __ \/ /  _ \/  _/
//  \___/__, /__//_/_/\_\ \__/__//_/\__, /_/__//_/\__/
//      /___/                       /___/ 
// 
//  Copyright (C) 2003~2006 fallingCAT studios. All Rights Reserved.
//	URL : http://www.LynxEngine.net
//
//--------------------------------------------------------------------------
//
//  Best viewed with Tabs = 4.
//  Created by Owen Wu : 2004/07/27
//  Last Update : 
//
//###########################################################################

#include <LynxEngine_PCH.h>
#include <LynxFileOutputDevice.h>

namespace LynxEngine 
{	
	/*
	//-------------------------------------------------------------------------------------------------------
	//
	//  說明:   
	//-------------------------------------------------------------------------------------------------------
	CFileOutputDevice::CFileOutputDevice(void)	
	{
	}	
	//-------------------------------------------------------------------------------------------------------
	//
	//  說明:   
	//-------------------------------------------------------------------------------------------------------
	CFileOutputDevice::~CFileOutputDevice(void)
	{
	}
	//-------------------------------------------------------------------------------------------------------
	//
	//  說明:   
	//-------------------------------------------------------------------------------------------------------
	void CFileOutputDevice::vOpen(const CString& name) 
	{
		if (LYNX_OPEN_FILE(&m_File, name.c_str(), (LYNX_FOT_WRITE|LYNX_FOT_TEXT), LYNX_FILE_STR))
		{
			m_FileName = name;
			LYNX_CLOSE_FILE(&m_File);
		}		
	}
	//-------------------------------------------------------------------------------------------------------
	//
	//  說明:   
	//-------------------------------------------------------------------------------------------------------
	void CFileOutputDevice::vClose() 
	{
		LYNX_CLOSE_FILE(&m_File);
	}
	//-------------------------------------------------------------------------------------------------------
	//
	//  說明:   
	//-------------------------------------------------------------------------------------------------------
	void CFileOutputDevice::vClear() 
	{
	}
	//-------------------------------------------------------------------------------------------------------
	//
	//  說明:   
	//-------------------------------------------------------------------------------------------------------
	void CFileOutputDevice::vAppend(const CString& str) 
	{
		#if (defined __iOS__ || defined __ANDROID__)
		#else
			m_File.FS.fp = _tfopen(m_FileName.c_str(), _T("at"));
			if (m_File.FS.fp)
				LYNX_FILE_PUTSTR((str.c_str()), &m_File); 			
			vClose();
		#endif
	}
	//-------------------------------------------------------------------------------------------------------
	//
	//  說明:   
	//-------------------------------------------------------------------------------------------------------
	void CFileOutputDevice::vOutput(const CString& str) 
	{
		#if (defined __iOS__ || defined __ANDROID__)
		#else		
			m_File.FS.fp = _tfopen(m_FileName.c_str(), _T("at"));
			if (m_File.FS.fp)
				LYNX_FILE_PUTSTR((str.c_str()), &m_File); 			
			vClose();
		#endif
	}
	*/

	//-------------------------------------------------------------------------------------------------------
	//
	//  說明:   
	//-------------------------------------------------------------------------------------------------------
	CFileOutputDevice::CFileOutputDevice(void)
	{
		m_File = LYNXNEW CPlatformFileStream;
	}
	//-------------------------------------------------------------------------------------------------------
	//
	//  說明:   
	//-------------------------------------------------------------------------------------------------------
	CFileOutputDevice::~CFileOutputDevice(void)
	{
		if (m_File)
		{
			LYNXDEL m_File;
			m_File = NULL;
		}
	}
	//-------------------------------------------------------------------------------------------------------
	//
	//  說明:   
	//-------------------------------------------------------------------------------------------------------
	void CFileOutputDevice::vOpen(const CString& name)
	{
		if (m_File->vOpen(name.c_str(), (CStream::Text | CStream::Write)))
		{
			m_FileName = name;
			m_File->vClose();
		}
	}
	//-------------------------------------------------------------------------------------------------------
	//
	//  說明:   
	//-------------------------------------------------------------------------------------------------------
	void CFileOutputDevice::vClose()
	{
		m_File->vClose();
	}
	//-------------------------------------------------------------------------------------------------------
	//
	//  說明:   
	//-------------------------------------------------------------------------------------------------------
	void CFileOutputDevice::vClear()
	{
	}
	//-------------------------------------------------------------------------------------------------------
	//
	//  說明:   
	//-------------------------------------------------------------------------------------------------------
	void CFileOutputDevice::vAppend(const CString& str)
	{		
		m_File->vOpen(m_FileName, (CStream::Text | CStream::Append));
		m_File->vWrite(str);
		m_File->vClose();
	}
	//-------------------------------------------------------------------------------------------------------
	//
	//  說明:   
	//-------------------------------------------------------------------------------------------------------
	void CFileOutputDevice::vOutput(const CString& str)
	{
		m_File->vOpen(m_FileName, (CStream::Text | CStream::Append));
		m_File->vWrite(str);
		m_File->vClose();
	}
}