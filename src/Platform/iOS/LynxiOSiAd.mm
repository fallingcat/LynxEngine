//###########################################################################//    __                    ____            __//   / /  __ __ ___ _  __  / __/___  ____  /_/___  ____//  / /__/ // /  _ \ \/ / / __/  _ \/ __ \/ /  _ \/  _///  \___/__, /__//_/_/\_\ \__/__//_/\__, /_/__//_/\__///      /___/                       /___/ // //  Copyright (C) 2003~2006 fallingCAT studios. All Rights Reserved.//	URL : http://www.LynxEngine.net////--------------------------------------------------------------------------////  Best viewed with Tabs = 4.//  Created by Owen Wu : 2004/07/27//  Last Update : ////############################################################################include <LynxEngine_PCH.h>#import <iAd/iAd.h>#include <Platform/iOS/LynxiOSiAd.h>#include <Platform/iOS/LynxiOSGameFrameworkKernel.h>#import <UIKit/UIKit.h>#import <CoreMotion/CoreMotion.h>namespace LynxEngine {		namespace AdSystem 	{		namespace iOS		{						//-------------------------------------------------------------------------------------------------------			//			//  ª°©˙:   			//-------------------------------------------------------------------------------------------------------			CiAd::CiAd(CAdSystem* lpsys)			: CAd(lpsys)			{                m_ADView = nil;			}			//-------------------------------------------------------------------------------------------------------			//			//  ª°©˙:   			//-------------------------------------------------------------------------------------------------------			CiAd::~CiAd(void)			{                if (m_ADView)                {                    [m_ADView removeFromSuperview];                    m_ADView = nil;                }			}			//-------------------------------------------------------------------------------------------------------            //            //  ª°©˙:               //-------------------------------------------------------------------------------------------------------	            LYNXBOOL CiAd::vCreate(const CCreationDesc& desc)            {						                CAdCreationDesc* Desc = (CAdCreationDesc*)(&desc);                                // Depending on our orientation when this method is called, we set our initial content size.                // If you only support portrait or landscape orientations, then you can remove this check and                // select either ADBannerContentSizeIdentifierPortrait (if portrait only) or ADBannerContentSizeIdentifierLandscape (if landscape only).                NSString *contentSize;                if (&ADBannerContentSizeIdentifierPortrait != nil)                {                    if (Desc->m_Size.x == 480 || Desc->m_Size.x == 960 || Desc->m_Size.x == 1024)                        contentSize = ADBannerContentSizeIdentifierLandscape;                    else                        contentSize = ADBannerContentSizeIdentifierPortrait;                }                else                {                    if (Desc->m_Size.x == 480 || Desc->m_Size.x == 960 || Desc->m_Size.x == 1024)                        contentSize = ADBannerContentSizeIdentifier480x32;                    else                        contentSize = ADBannerContentSizeIdentifier320x50;                }                // Calculate the intial location for the banner.                // We want this banner to be at the bottom of the view controller, but placed                // offscreen to ensure that the user won't see the banner until its ready.                // We'll be informed when we have an ad to show because -bannerViewDidLoadAd: will be called.                CGRect frame;                frame.size = [ADBannerView sizeFromBannerContentSizeIdentifier:contentSize];                frame.origin = CGPointMake(Desc->m_Position.x, Desc->m_Position.y);                                // Now to create and configure the banner view                ADBannerView *bannerView = [[ADBannerView alloc] initWithFrame:frame];                // Set the delegate to self, so that we are notified of ad responses.                bannerView.delegate = id<ADBannerViewDelegate>(((LynxEngine::GameFramework::iOS::CKernel*)glpKernel)->GetlpViewController());                // Set the autoresizing mask so that the banner is pinned to the bottom                //bannerView.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight | UIViewAutoresizingFlexibleTopMargin;                // Since we support all orientations in this view controller, support portrait and landscape content sizes.                // If you only supported landscape or portrait, you could remove the other from this set.                                bannerView.requiredContentSizeIdentifiers = [NSSet setWithObjects:contentSize, nil];                 //bannerView.requiredContentSizeIdentifiers = (&ADBannerContentSizeIdentifierPortrait != nil) ?                //[NSSet setWithObjects:ADBannerContentSizeIdentifierPortrait, ADBannerContentSizeIdentifierLandscape, nil] :                 //[NSSet setWithObjects:ADBannerContentSizeIdentifier320x50, ADBannerContentSizeIdentifier480x32, nil];                                // At this point the ad banner is now be visible and looking for an ad.                [((LynxEngine::GameFramework::iOS::CKernel*)glpKernel)->GetlpViewController().view addSubview:bannerView];                m_ADView = bannerView;                //[bannerView release];                                m_Rect.x1 = Desc->m_Position.x;                m_Rect.y1 = Desc->m_Position.y;                m_Rect.x2 = m_Rect.x1 + Desc->m_Size.x;                m_Rect.y2 = m_Rect.y1 + Desc->m_Size.y;                                return LYNX_TRUE;            }            //-------------------------------------------------------------------------------------------------------            //            //  ª°©˙:               //-------------------------------------------------------------------------------------------------------	            LYNXBOOL CiAd::vInit()            {                return LYNX_TRUE;            }            //-------------------------------------------------------------------------------------------------------            //            //  ª°©˙:               //-------------------------------------------------------------------------------------------------------	            void CiAd::vLoop(float step)            {            }            //-------------------------------------------------------------------------------------------------------            //            //  ª°©˙:               //-------------------------------------------------------------------------------------------------------	            void CiAd::vRender()            {		            }            //-------------------------------------------------------------------------------------------------------            //            //  ª°©˙:               //-------------------------------------------------------------------------------------------------------	            LYNXBOOL CiAd::vDestroy()            {		                return LYNX_TRUE;            }		}	}}