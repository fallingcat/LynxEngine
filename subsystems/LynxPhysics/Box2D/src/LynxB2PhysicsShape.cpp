#include <LynxEngine_PCH.h>
#include <LynxB2PhysicsShape.h>
#include <LynxB2PhysicsObj.h>
#include <LynxB2PhysicsSpace.h>

namespace LynxPhysics 
{
	namespace Box2D 
	{
		//-------------------------------------------------------------------------------------------------------
		//
		//  說明:   
		//-------------------------------------------------------------------------------------------------------
		CPhysicsShape::CPhysicsShape(LynxEngine::PhysicsSystem::CPhysicsSpace* lps)
		: LynxEngine::PhysicsSystem::CPhysicsShape(lps)
		{	
			m_lpShape = 0;
		}
		//-------------------------------------------------------------------------------------------------------
		//
		//  說明:   
		//-------------------------------------------------------------------------------------------------------
		CPhysicsShape::~CPhysicsShape(void)
		{
			vDestory();
		}
		//-------------------------------------------------------------------------------------------------------
		//
		//  說明:   
		//-------------------------------------------------------------------------------------------------------		
		void CPhysicsShape::vDestory() 
		{ 
			//LYNX_ASSERT(m_lpObj);

			//((CPhysicsObj*)m_lpObj)->GetlpNxActor()->releaseShape(*m_lpShape);
			//LYNX_ASSERT(m_lpShape > 0); 
			//dGeomDestroy(m_lpShape); 
			//LYNX_ASSERT(m_TransGeometry > 0); 
			//dGeomDestroy(m_TransGeometry); 
			//m_lpBody = NULL; 
		}
		//-------------------------------------------------------------------------------------------------------
		//
		//  說明:   
		//-------------------------------------------------------------------------------------------------------		
		void CPhysicsShape::CreateStaticPhyObj() 
		{
			m_lpObj = m_lpSpace->GetlpWorld()->vCreateObj(LynxEngine::PhysicsSystem::CPhysicsObj::STATIC, this);			
			m_lpObj->SetName(GetName() + LynxEngine::CString(_T(".PhyObj")));
		}		
		//-------------------------------------------------------------------------------------------------------
		//
		//  說明:   
		//-------------------------------------------------------------------------------------------------------		
		void CPhysicsShape::DestoryPhyObj() 
		{
			if (m_lpObj)
			{
				m_lpObj->vDestory();
				LYNXDEL m_lpObj;
				m_lpObj = NULL;
			}
		}
		//-------------------------------------------------------------------------------------------------------
		//
		//  說明:   
		//-------------------------------------------------------------------------------------------------------
		void CPhysicsShape::vSetTransformMatrix(const CMatrix4& m) 
		{ 						
		}
		//-------------------------------------------------------------------------------------------------------
		//
		//  說明:   
		//-------------------------------------------------------------------------------------------------------
		CMatrix4& CPhysicsShape::vGetTransformMatrix()
		{
			return m_M;
		}		
		//-------------------------------------------------------------------------------------------------------
		//
		//  說明:   
		//-------------------------------------------------------------------------------------------------------
		void CPhysicsShape::vSetLocalTransformMatrix(const CMatrix4& m) 
		{ 								
		}
		//-------------------------------------------------------------------------------------------------------
		//
		//  說明:   
		//-------------------------------------------------------------------------------------------------------
		CMatrix4& CPhysicsShape::vGetLocalTransformMatrix()
		{
			return m_LocalM;
		}
	}
}